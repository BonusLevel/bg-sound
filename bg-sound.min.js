!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).BgSound=e()}}(function(){var e,t,r,n,o,i=(e=function(e,t){var r=1e3,n=6e4,o=36e5,i=24*o;function a(e,t,r,n){var o=t>=1.5*r;return Math.round(e/r)+" "+n+(o?"s":"")}e.exports=function(e,t){t=t||{};var s,u,l=typeof e;if("string"===l&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var a=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"weeks":case"week":case"w":return 6048e5*a;case"days":case"day":case"d":return a*i;case"hours":case"hour":case"hrs":case"hr":case"h":return a*o;case"minutes":case"minute":case"mins":case"min":case"m":return a*n;case"seconds":case"second":case"secs":case"sec":case"s":return a*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}(e);if("number"===l&&isFinite(e))return t.long?(s=e,(u=Math.abs(s))>=i?a(s,u,i,"day"):u>=o?a(s,u,o,"hour"):u>=n?a(s,u,n,"minute"):u>=r?a(s,u,r,"second"):s+" ms"):function(e){var t=Math.abs(e);return t>=i?Math.round(e/i)+"d":t>=o?Math.round(e/o)+"h":t>=n?Math.round(e/n)+"m":t>=r?Math.round(e/r)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(r){return t||e(t={exports:{},parent:r},t.exports),t.exports}),a=r={};function s(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function l(e){if(n===setTimeout)return setTimeout(e,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(t){n=s}try{o="function"==typeof clearTimeout?clearTimeout:u}catch(t){o=u}}();var c,d=[],f=!1,p=-1;function h(){f&&c&&(f=!1,c.length?d=c.concat(d):p=-1,d.length&&m())}function m(){if(!f){var e=l(h);f=!0;for(var r=d.length;r;){for(c=d,d=[];++p<r;)c&&c[p].run();p=-1,r=d.length}c=null,f=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===u||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(e)}}function _(e,t){this.fun=e,this.array=t}function g(){}a.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];d.push(new _(e,t)),1!==d.length||f||l(m)},_.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=g,a.addListener=g,a.once=g,a.off=g,a.removeListener=g,a.removeAllListeners=g,a.emit=g,a.prependListener=g,a.prependOnceListener=g,a.listeners=function(e){return[]},a.binding=function(e){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw new Error("process.chdir is not supported")},a.umask=function(){return 0};var y={};(function(e){y.log=function(...e){return"object"==typeof console&&console.log&&console.log(...e)},y.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+y.humanize(this.diff),!this.useColors)return;const t="color: "+this.color;e.splice(1,0,t,"color: inherit");let r=0,n=0;e[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(r++,"%c"===e&&(n=r))}),e.splice(n,0,t)},y.save=function(e){try{e?y.storage.setItem("debug",e):y.storage.removeItem("debug")}catch(t){}},y.load=function(){let t;try{t=y.storage.getItem("debug")}catch(r){}return!t&&void 0!==e&&"env"in e&&(t=e.env.DEBUG),t},y.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},y.storage=function(){try{return localStorage}catch(e){}}(),y.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],y=function(e){function t(e){let t=0;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return r.colors[Math.abs(t)%r.colors.length]}function r(e){let i;function a(...e){if(!a.enabled)return;const t=a,n=Number(new Date),o=n-(i||n);t.diff=o,t.prev=i,t.curr=n,i=n,e[0]=r.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(n,o)=>{if("%%"===n)return n;s++;const i=r.formatters[o];if("function"==typeof i){const r=e[s];n=i.call(t,r),e.splice(s,1),s--}return n}),r.formatArgs.call(t,e),(t.log||r.log).apply(t,e)}return a.namespace=e,a.enabled=r.enabled(e),a.useColors=r.useColors(),a.color=t(e),a.destroy=n,a.extend=o,"function"==typeof r.init&&r.init(a),r.instances.push(a),a}function n(){const e=r.instances.indexOf(this);return-1!==e&&(r.instances.splice(e,1),!0)}function o(e,t){const n=r(this.namespace+(void 0===t?":":t)+e);return n.log=this.log,n}function a(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return r.debug=r,r.default=r,r.coerce=function(e){return e instanceof Error?e.stack||e.message:e},r.disable=function(){const e=[...r.names.map(a),...r.skips.map(a).map(e=>"-"+e)].join(",");return r.enable(""),e},r.enable=function(e){let t;r.save(e),r.names=[],r.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),o=n.length;for(t=0;t<o;t++)n[t]&&("-"===(e=n[t].replace(/\*/g,".*?"))[0]?r.skips.push(new RegExp("^"+e.substr(1)+"$")):r.names.push(new RegExp("^"+e+"$")));for(t=0;t<r.instances.length;t++){const e=r.instances[t];e.enabled=r.enabled(e.namespace)}},r.enabled=function(e){if("*"===e[e.length-1])return!0;let t,n;for(t=0,n=r.skips.length;t<n;t++)if(r.skips[t].test(e))return!1;for(t=0,n=r.names.length;t<n;t++)if(r.names[t].test(e))return!0;return!1},r.humanize=i({}),Object.keys(e).forEach(t=>{r[t]=e[t]}),r.instances=[],r.names=[],r.skips=[],r.formatters={},r.selectColor=t,r.enable(r.load()),r}(y);const{formatters:t}=y;t.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}).call(this,r);var w,v=Object.create||function(e){var t=function(){};return t.prototype=e,new t},b=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return r},E=Function.prototype.bind||function(e){var t=this;return function(){return t.apply(e,arguments)}};function k(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=v(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}w=k,k.EventEmitter=k,k.prototype._events=void 0,k.prototype._maxListeners=void 0;var C,D=10;try{var F={};Object.defineProperty&&Object.defineProperty(F,"x",{value:0}),C=0===F.x}catch(Y){C=!1}function T(e){return void 0===e._maxListeners?k.defaultMaxListeners:e._maxListeners}function S(e,t,r,n){var o,i,a;if("function"!=typeof r)throw new TypeError('"listener" argument must be a function');if((i=e._events)?(i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),a=i[t]):(i=e._events=v(null),e._eventsCount=0),a){if("function"==typeof a?a=i[t]=n?[r,a]:[a,r]:n?a.unshift(r):a.push(r),!a.warned&&(o=T(e))&&o>0&&a.length>o){a.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+a.length+' "'+String(t)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=a.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",s.name,s.message)}}else a=i[t]=r,++e._eventsCount;return e}function P(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var e=new Array(arguments.length),t=0;t<e.length;++t)e[t]=arguments[t];this.listener.apply(this.target,e)}}function A(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},o=E.call(P,n);return o.listener=r,n.wrapFn=o,o}function x(e,t,r){var n=e._events;if(!n)return[];var o=n[t];return o?"function"==typeof o?r?[o.listener||o]:[o]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(o):M(o,o.length):[]}function L(e){var t=this._events;if(t){var r=t[e];if("function"==typeof r)return 1;if(r)return r.length}return 0}function M(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}C?Object.defineProperty(k,"defaultMaxListeners",{enumerable:!0,get:function(){return D},set:function(e){if("number"!=typeof e||e<0||e!=e)throw new TypeError('"defaultMaxListeners" must be a positive number');D=e}}):k.defaultMaxListeners=D,k.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},k.prototype.getMaxListeners=function(){return T(this)},k.prototype.emit=function(e){var t,r,n,o,i,a,s="error"===e;if(a=this._events)s=s&&null==a.error;else if(!s)return!1;if(s){if(arguments.length>1&&(t=arguments[1]),t instanceof Error)throw t;var u=new Error('Unhandled "error" event. ('+t+")");throw u.context=t,u}if(!(r=a[e]))return!1;var l="function"==typeof r;switch(n=arguments.length){case 1:!function(e,t,r){if(t)e.call(r);else for(var n=e.length,o=M(e,n),i=0;i<n;++i)o[i].call(r)}(r,l,this);break;case 2:!function(e,t,r,n){if(t)e.call(r,n);else for(var o=e.length,i=M(e,o),a=0;a<o;++a)i[a].call(r,n)}(r,l,this,arguments[1]);break;case 3:!function(e,t,r,n,o){if(t)e.call(r,n,o);else for(var i=e.length,a=M(e,i),s=0;s<i;++s)a[s].call(r,n,o)}(r,l,this,arguments[1],arguments[2]);break;case 4:!function(e,t,r,n,o,i){if(t)e.call(r,n,o,i);else for(var a=e.length,s=M(e,a),u=0;u<a;++u)s[u].call(r,n,o,i)}(r,l,this,arguments[1],arguments[2],arguments[3]);break;default:for(o=new Array(n-1),i=1;i<n;i++)o[i-1]=arguments[i];!function(e,t,r,n){if(t)e.apply(r,n);else for(var o=e.length,i=M(e,o),a=0;a<o;++a)i[a].apply(r,n)}(r,l,this,o)}return!0},k.prototype.addListener=function(e,t){return S(this,e,t,!1)},k.prototype.on=k.prototype.addListener,k.prototype.prependListener=function(e,t){return S(this,e,t,!0)},k.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,A(this,e,t)),this},k.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,A(this,e,t)),this},k.prototype.removeListener=function(e,t){var r,n,o,i,a;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(n=this._events))return this;if(!(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=v(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(o=-1,i=r.length-1;i>=0;i--)if(r[i]===t||r[i].listener===t){a=r[i].listener,o=i;break}if(o<0)return this;0===o?r.shift():function(e,t){for(var r=o,n=r+1,i=e.length;n<i;r+=1,n+=1)e[r]=e[n];e.pop()}(r),1===r.length&&(n[e]=r[0]),n.removeListener&&this.emit("removeListener",e,a||t)}return this},k.prototype.removeAllListeners=function(e){var t,r,n;if(!(r=this._events))return this;if(!r.removeListener)return 0===arguments.length?(this._events=v(null),this._eventsCount=0):r[e]&&(0==--this._eventsCount?this._events=v(null):delete r[e]),this;if(0===arguments.length){var o,i=b(r);for(n=0;n<i.length;++n)"removeListener"!==(o=i[n])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=v(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},k.prototype.listeners=function(e){return x(this,e,!0)},k.prototype.rawListeners=function(e){return x(this,e,!1)},k.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):L.call(e,t)},k.prototype.listenerCount=L,k.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var R={},B=[],O=[],I="insert-css: You need to provide a CSS string. Usage: insertCss(cssString[, options]).";function N(e,t){if(t=t||{},void 0===e)throw new Error(I);var r,n=!0===t.prepend?"prepend":"append",o=void 0!==t.container?t.container:document.querySelector("head"),i=B.indexOf(o);return-1===i&&(i=B.push(o)-1,O[i]={}),void 0!==O[i]&&void 0!==O[i][n]?r=O[i][n]:(r=O[i][n]=function(){var e=document.createElement("style");return e.setAttribute("type","text/css"),e}(),"prepend"===n?o.insertBefore(r,o.childNodes[0]):o.appendChild(r)),65279===e.charCodeAt(0)&&(e=e.substr(1,e.length)),r.styleSheet?r.styleSheet.cssText+=e:r.textContent+=e,r}(R=N).insertCss=N;var z,j={exports:{}},U=(z="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,function(e){var r,n=void 0!==(e=e||{})?e:{},o={};for(r in n)n.hasOwnProperty(r)&&(o[r]=n[r]);n.arguments=[],n.thisProgram="./this.program",n.quit=function(e,t){throw t},n.preRun=[],n.postRun=[];var i=!0,a=!1,s="";(i||a)&&(a?s=self.location.href:document.currentScript&&(s=document.currentScript.src),z&&(s=z),s=0!==s.indexOf("blob:")?s.substr(0,s.lastIndexOf("/")+1):"",n.read=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},a&&(n.readBinary=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),n.readAsync=function(e,t,r){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){200==n.status||0==n.status&&n.response?t(n.response):r()},n.onerror=r,n.send(null)},n.setWindowTitle=function(e){document.title=e});var u=n.print||("undefined"!=typeof console?console.log.bind(console):"undefined"!=typeof print?print:null),l=n.printErr||("undefined"!=typeof printErr?printErr:"undefined"!=typeof console&&console.warn.bind(console)||u);for(r in o)o.hasOwnProperty(r)&&(n[r]=o[r]);o=void 0;var c,d={"f64-rem":function(e,t){return e%t},debugger:function(){}};new Array(0),"object"!=typeof WebAssembly&&l("no native wasm support detected");var f,p,h,m,_,g=!1,y="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function w(e,t,r){for(var n=t+r,o=t;e[o]&&!(o>=n);)++o;if(o-t>16&&e.subarray&&y)return y.decode(e.subarray(t,o));for(var i="";t<o;){var a=e[t++];if(128&a){var s=63&e[t++];if(192!=(224&a)){var u=63&e[t++];if((a=224==(240&a)?(15&a)<<12|s<<6|u:(7&a)<<18|s<<12|u<<6|63&e[t++])<65536)i+=String.fromCharCode(a);else{var l=a-65536;i+=String.fromCharCode(55296|l>>10,56320|1023&l)}}else i+=String.fromCharCode((31&a)<<6|s)}else i+=String.fromCharCode(a)}return i}function v(e,t){return e?w(h,e,t):""}function b(e,t,r,n){if(!(n>0))return 0;for(var o=r,i=r+n-1,a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s>=55296&&s<=57343&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++a)),s<=127){if(r>=i)break;t[r++]=s}else if(s<=2047){if(r+1>=i)break;t[r++]=192|s>>6,t[r++]=128|63&s}else if(s<=65535){if(r+2>=i)break;t[r++]=224|s>>12,t[r++]=128|s>>6&63,t[r++]=128|63&s}else{if(r+3>=i)break;t[r++]=240|s>>18,t[r++]=128|s>>12&63,t[r++]=128|s>>6&63,t[r++]=128|63&s}}return t[r]=0,r-o}function E(e){for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);n>=55296&&n<=57343&&(n=65536+((1023&n)<<10)|1023&e.charCodeAt(++r)),n<=127?++t:t+=n<=2047?2:n<=65535?3:4}return t}function k(e,t){return e%t>0&&(e+=t-e%t),e}function C(){n.HEAP8=p=new Int8Array(f),n.HEAP16=m=new Int16Array(f),n.HEAP32=_=new Int32Array(f),n.HEAPU8=h=new Uint8Array(f),n.HEAPU16=new Uint16Array(f),n.HEAPU32=new Uint32Array(f),n.HEAPF32=new Float32Array(f),n.HEAPF64=new Float64Array(f)}"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");var D=n.TOTAL_MEMORY||16777216;function F(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var r=t.func;"number"==typeof r?void 0===t.arg?n.dynCall_v(r):n.dynCall_vi(r,t.arg):r(void 0===t.arg?null:t.arg)}else t()}}D<5242880&&l("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+D+"! (TOTAL_STACK=5242880)"),n.buffer?f=n.buffer:"object"==typeof WebAssembly&&"function"==typeof WebAssembly.Memory?(c=new WebAssembly.Memory({initial:D/65536}),f=c.buffer):f=new ArrayBuffer(D),C(),_[2712]=5253760;var T=[],S=[],P=[],A=[],x=Math.abs,L=Math.ceil,M=Math.floor,R=Math.min,B=0,O=null,I=null;function N(e){B++,n.monitorRunDependencies&&n.monitorRunDependencies(B)}function j(e){if(B--,n.monitorRunDependencies&&n.monitorRunDependencies(B),0==B&&(null!==O&&(clearInterval(O),O=null),I)){var t=I;I=null,t()}}n.preloadedImages={},n.preloadedAudios={};var U="data:application/octet-stream;base64,";function H(e){return String.prototype.startsWith?e.startsWith(U):0===e.indexOf(U)}var W,q="libtimidity.wasm";function G(){try{if(n.wasmBinary)return new Uint8Array(n.wasmBinary);if(n.readBinary)return n.readBinary(q);throw"both async and sync fetching of the wasm failed"}catch(l){ae(l)}}H(q)||(W=q,q=n.locateFile?n.locateFile(W,s):s+W),n.asm=function(e,r,o){return r.memory=c,r.table=new WebAssembly.Table({initial:24,maximum:24,element:"anyfunc"}),r.__memory_base=1024,r.__table_base=0,function(e){var r={env:e,global:{NaN:NaN,Infinity:1/0},"global.Math":Math,asm2wasm:d};function o(e,t){var r=e.exports;n.asm=r,j()}function s(e){o(e.instance)}function u(e){return(n.wasmBinary||!i&&!a||"function"!=typeof fetch?new Promise(function(e,t){e(G())}):fetch(q,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+q+"'";return e.arrayBuffer()}).catch(function(){return G()})).then(function(e){return WebAssembly.instantiate(e,r)}).then(e,function(e){l("failed to asynchronously prepare wasm: "+e),ae(e)})}if(N(),n.instantiateWasm)try{return n.instantiateWasm(r,o)}catch(t){return l("Module.instantiateWasm callback failed with error: "+t),!1}return function(){if(n.wasmBinary||"function"!=typeof WebAssembly.instantiateStreaming||H(q)||"function"!=typeof fetch)return u(s);fetch(q,{credentials:"same-origin"}).then(function(e){return WebAssembly.instantiateStreaming(e,r).then(s,function(e){l("wasm streaming compile failed: "+e),l("falling back to ArrayBuffer instantiation"),u(s)})})}(),{}}(r)};var X={splitPath:function(e){return/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(e).slice(1)},normalizeArray:function(e,t){for(var r=0,n=e.length-1;n>=0;n--){var o=e[n];"."===o?e.splice(n,1):".."===o?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r;r--)e.unshift("..");return e},normalize:function(e){var t="/"===e.charAt(0),r="/"===e.substr(-1);return(e=X.normalizeArray(e.split("/").filter(function(e){return!!e}),!t).join("/"))||t||(e="."),e&&r&&(e+="/"),(t?"/":"")+e},dirname:function(e){var t=X.splitPath(e),r=t[0],n=t[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):"."},basename:function(e){if("/"===e)return"/";var t=e.lastIndexOf("/");return-1===t?e:e.substr(t+1)},extname:function(e){return X.splitPath(e)[3]},join:function(){var e=Array.prototype.slice.call(arguments,0);return X.normalize(e.join("/"))},join2:function(e,t){return X.normalize(e+"/"+t)}};function $(e){return n.___errno_location&&(_[n.___errno_location()>>2]=e),e}var K={resolve:function(){for(var e="",t=!1,r=arguments.length-1;r>=-1&&!t;r--){var n=r>=0?arguments[r]:Y.cwd();if("string"!=typeof n)throw new TypeError("Arguments to path.resolve must be strings");if(!n)return"";e=n+"/"+e,t="/"===n.charAt(0)}return(t?"/":"")+(e=X.normalizeArray(e.split("/").filter(function(e){return!!e}),!t).join("/"))||"."},relative:function(e,t){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;r>=0&&""===e[r];r--);return t>r?[]:e.slice(t,r-t+1)}e=K.resolve(e).substr(1),t=K.resolve(t).substr(1);for(var n=r(e.split("/")),o=r(t.split("/")),i=Math.min(n.length,o.length),a=i,s=0;s<i;s++)if(n[s]!==o[s]){a=s;break}var u=[];for(s=a;s<n.length;s++)u.push("..");return(u=u.concat(o.slice(a))).join("/")}},V={ttys:[],init:function(){},shutdown:function(){},register:function(e,t){V.ttys[e]={input:[],output:[],ops:t},Y.registerDevice(e,V.stream_ops)},stream_ops:{open:function(e){var t=V.ttys[e.node.rdev];if(!t)throw new Y.ErrnoError(19);e.tty=t,e.seekable=!1},close:function(e){e.tty.ops.flush(e.tty)},flush:function(e){e.tty.ops.flush(e.tty)},read:function(e,r,n,o,i){if(!e.tty||!e.tty.ops.get_char)throw new Y.ErrnoError(6);for(var a=0,s=0;s<o;s++){var u;try{u=e.tty.ops.get_char(e.tty)}catch(t){throw new Y.ErrnoError(5)}if(void 0===u&&0===a)throw new Y.ErrnoError(11);if(null==u)break;a++,r[n+s]=u}return a&&(e.node.timestamp=Date.now()),a},write:function(e,r,n,o,i){if(!e.tty||!e.tty.ops.put_char)throw new Y.ErrnoError(6);try{for(var a=0;a<o;a++)e.tty.ops.put_char(e.tty,r[n+a])}catch(t){throw new Y.ErrnoError(5)}return o&&(e.node.timestamp=Date.now()),a}},default_tty_ops:{get_char:function(e){if(!e.input.length){var t=null;if("undefined"!=typeof window&&"function"==typeof window.prompt?null!==(t=window.prompt("Input: "))&&(t+="\n"):"function"==typeof readline&&null!==(t=readline())&&(t+="\n"),!t)return null;e.input=ee(t,!0)}return e.input.shift()},put_char:function(e,t){null===t||10===t?(u(w(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},flush:function(e){e.output&&e.output.length>0&&(u(w(e.output,0)),e.output=[])}},default_tty1_ops:{put_char:function(e,t){null===t||10===t?(l(w(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},flush:function(e){e.output&&e.output.length>0&&(l(w(e.output,0)),e.output=[])}}},J={ops_table:null,mount:function(e){return J.createNode(null,"/",16895,0)},createNode:function(e,t,r,n){if(Y.isBlkdev(r)||Y.isFIFO(r))throw new Y.ErrnoError(1);J.ops_table||(J.ops_table={dir:{node:{getattr:J.node_ops.getattr,setattr:J.node_ops.setattr,lookup:J.node_ops.lookup,mknod:J.node_ops.mknod,rename:J.node_ops.rename,unlink:J.node_ops.unlink,rmdir:J.node_ops.rmdir,readdir:J.node_ops.readdir,symlink:J.node_ops.symlink},stream:{llseek:J.stream_ops.llseek}},file:{node:{getattr:J.node_ops.getattr,setattr:J.node_ops.setattr},stream:{llseek:J.stream_ops.llseek,read:J.stream_ops.read,write:J.stream_ops.write,allocate:J.stream_ops.allocate,mmap:J.stream_ops.mmap,msync:J.stream_ops.msync}},link:{node:{getattr:J.node_ops.getattr,setattr:J.node_ops.setattr,readlink:J.node_ops.readlink},stream:{}},chrdev:{node:{getattr:J.node_ops.getattr,setattr:J.node_ops.setattr},stream:Y.chrdev_stream_ops}});var o=Y.createNode(e,t,r,n);return Y.isDir(o.mode)?(o.node_ops=J.ops_table.dir.node,o.stream_ops=J.ops_table.dir.stream,o.contents={}):Y.isFile(o.mode)?(o.node_ops=J.ops_table.file.node,o.stream_ops=J.ops_table.file.stream,o.usedBytes=0,o.contents=null):Y.isLink(o.mode)?(o.node_ops=J.ops_table.link.node,o.stream_ops=J.ops_table.link.stream):Y.isChrdev(o.mode)&&(o.node_ops=J.ops_table.chrdev.node,o.stream_ops=J.ops_table.chrdev.stream),o.timestamp=Date.now(),e&&(e.contents[t]=o),o},getFileDataAsRegularArray:function(e){if(e.contents&&e.contents.subarray){for(var t=[],r=0;r<e.usedBytes;++r)t.push(e.contents[r]);return t}return e.contents},getFileDataAsTypedArray:function(e){return e.contents?e.contents.subarray?e.contents.subarray(0,e.usedBytes):new Uint8Array(e.contents):new Uint8Array},expandFileStorage:function(e,t){var r=e.contents?e.contents.length:0;if(!(r>=t)){t=Math.max(t,r*(r<1048576?2:1.125)|0),0!=r&&(t=Math.max(t,256));var n=e.contents;e.contents=new Uint8Array(t),e.usedBytes>0&&e.contents.set(n.subarray(0,e.usedBytes),0)}},resizeFileStorage:function(e,t){if(e.usedBytes!=t){if(0==t)return e.contents=null,void(e.usedBytes=0);if(!e.contents||e.contents.subarray){var r=e.contents;return e.contents=new Uint8Array(new ArrayBuffer(t)),r&&e.contents.set(r.subarray(0,Math.min(t,e.usedBytes))),void(e.usedBytes=t)}if(e.contents||(e.contents=[]),e.contents.length>t)e.contents.length=t;else for(;e.contents.length<t;)e.contents.push(0);e.usedBytes=t}},node_ops:{getattr:function(e){var t={};return t.dev=Y.isChrdev(e.mode)?e.id:1,t.ino=e.id,t.mode=e.mode,t.nlink=1,t.uid=0,t.gid=0,t.rdev=e.rdev,Y.isDir(e.mode)?t.size=4096:Y.isFile(e.mode)?t.size=e.usedBytes:Y.isLink(e.mode)?t.size=e.link.length:t.size=0,t.atime=new Date(e.timestamp),t.mtime=new Date(e.timestamp),t.ctime=new Date(e.timestamp),t.blksize=4096,t.blocks=Math.ceil(t.size/t.blksize),t},setattr:function(e,t){void 0!==t.mode&&(e.mode=t.mode),void 0!==t.timestamp&&(e.timestamp=t.timestamp),void 0!==t.size&&J.resizeFileStorage(e,t.size)},lookup:function(e,t){throw Y.genericErrors[2]},mknod:function(e,t,r,n){return J.createNode(e,t,r,n)},rename:function(e,r,n){if(Y.isDir(e.mode)){var o;try{o=Y.lookupNode(r,n)}catch(t){}if(o)for(var i in o.contents)throw new Y.ErrnoError(39)}delete e.parent.contents[e.name],e.name=n,r.contents[n]=e,e.parent=r},unlink:function(e,t){delete e.contents[t]},rmdir:function(e,t){var r=Y.lookupNode(e,t);for(var n in r.contents)throw new Y.ErrnoError(39);delete e.contents[t]},readdir:function(e){var t=[".",".."];for(var r in e.contents)e.contents.hasOwnProperty(r)&&t.push(r);return t},symlink:function(e,t,r){var n=J.createNode(e,t,41471,0);return n.link=r,n},readlink:function(e){if(!Y.isLink(e.mode))throw new Y.ErrnoError(22);return e.link}},stream_ops:{read:function(e,t,r,n,o){var i=e.node.contents;if(o>=e.node.usedBytes)return 0;var a=Math.min(e.node.usedBytes-o,n);if(a>8&&i.subarray)t.set(i.subarray(o,o+a),r);else for(var s=0;s<a;s++)t[r+s]=i[o+s];return a},write:function(e,t,r,n,o,i){if(!n)return 0;var a=e.node;if(a.timestamp=Date.now(),t.subarray&&(!a.contents||a.contents.subarray)){if(0===a.usedBytes&&0===o)return a.contents=new Uint8Array(t.subarray(r,r+n)),a.usedBytes=n,n;if(o+n<=a.usedBytes)return a.contents.set(t.subarray(r,r+n),o),n}if(J.expandFileStorage(a,o+n),a.contents.subarray&&t.subarray)a.contents.set(t.subarray(r,r+n),o);else for(var s=0;s<n;s++)a.contents[o+s]=t[r+s];return a.usedBytes=Math.max(a.usedBytes,o+n),n},llseek:function(e,t,r){var n=t;if(1===r?n+=e.position:2===r&&Y.isFile(e.node.mode)&&(n+=e.node.usedBytes),n<0)throw new Y.ErrnoError(22);return n},allocate:function(e,t,r){J.expandFileStorage(e.node,t+r),e.node.usedBytes=Math.max(e.node.usedBytes,t+r)},mmap:function(e,t,r,n,o,i,a){if(!Y.isFile(e.node.mode))throw new Y.ErrnoError(19);var s,u,l=e.node.contents;if(2&a||l.buffer!==t&&l.buffer!==t.buffer){if((o>0||o+n<e.node.usedBytes)&&(l=l.subarray?l.subarray(o,o+n):Array.prototype.slice.call(l,o,o+n)),u=!0,!(s=ne(n)))throw new Y.ErrnoError(12);t.set(l,s)}else u=!1,s=l.byteOffset;return{ptr:s,allocated:u}},msync:function(e,t,r,n,o){if(!Y.isFile(e.node.mode))throw new Y.ErrnoError(19);return 2&o?0:(J.stream_ops.write(e,t,0,n,r,!1),0)}}},Y={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,trackingDelegate:{},tracking:{openFlags:{READ:1,WRITE:2}},ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,handleFSError:function(e){if(!(e instanceof Y.ErrnoError))throw e+" : "+(t=function(){var t=new Error;if(!t.stack){try{throw new Error(0)}catch(e){t=e}if(!t.stack)return"(no stack trace available)"}return t.stack.toString()}(),n.extraStackTrace&&(t+="\n"+n.extraStackTrace()),t.replace(/__Z[\w\d_]+/g,function(e){return e==e?e:e+" ["+e+"]"}));var t;return $(e.errno)},lookupPath:function(e,t){if(t=t||{},!(e=K.resolve(Y.cwd(),e)))return{path:"",node:null};var r={follow_mount:!0,recurse_count:0};for(var n in r)void 0===t[n]&&(t[n]=r[n]);if(t.recurse_count>8)throw new Y.ErrnoError(40);for(var o=X.normalizeArray(e.split("/").filter(function(e){return!!e}),!1),i=Y.root,a="/",s=0;s<o.length;s++){var u=s===o.length-1;if(u&&t.parent)break;if(i=Y.lookupNode(i,o[s]),a=X.join2(a,o[s]),Y.isMountpoint(i)&&(!u||u&&t.follow_mount)&&(i=i.mounted.root),!u||t.follow)for(var l=0;Y.isLink(i.mode);){var c=Y.readlink(a);if(a=K.resolve(X.dirname(a),c),i=Y.lookupPath(a,{recurse_count:t.recurse_count}).node,l++>40)throw new Y.ErrnoError(40)}}return{path:a,node:i}},getPath:function(e){for(var t;;){if(Y.isRoot(e)){var r=e.mount.mountpoint;return t?"/"!==r[r.length-1]?r+"/"+t:r+t:r}t=t?e.name+"/"+t:e.name,e=e.parent}},hashName:function(e,t){for(var r=0,n=0;n<t.length;n++)r=(r<<5)-r+t.charCodeAt(n)|0;return(e+r>>>0)%Y.nameTable.length},hashAddNode:function(e){var t=Y.hashName(e.parent.id,e.name);e.name_next=Y.nameTable[t],Y.nameTable[t]=e},hashRemoveNode:function(e){var t=Y.hashName(e.parent.id,e.name);if(Y.nameTable[t]===e)Y.nameTable[t]=e.name_next;else for(var r=Y.nameTable[t];r;){if(r.name_next===e){r.name_next=e.name_next;break}r=r.name_next}},lookupNode:function(e,t){var r=Y.mayLookup(e);if(r)throw new Y.ErrnoError(r,e);for(var n=Y.hashName(e.id,t),o=Y.nameTable[n];o;o=o.name_next){var i=o.name;if(o.parent.id===e.id&&i===t)return o}return Y.lookup(e,t)},createNode:function(e,t,r,n){Y.FSNode||(Y.FSNode=function(e,t,r,n){e||(e=this),this.parent=e,this.mount=e.mount,this.mounted=null,this.id=Y.nextInode++,this.name=t,this.mode=r,this.node_ops={},this.stream_ops={},this.rdev=n},Y.FSNode.prototype={},Object.defineProperties(Y.FSNode.prototype,{read:{get:function(){return 365==(365&this.mode)},set:function(e){e?this.mode|=365:this.mode&=-366}},write:{get:function(){return 146==(146&this.mode)},set:function(e){e?this.mode|=146:this.mode&=-147}},isFolder:{get:function(){return Y.isDir(this.mode)}},isDevice:{get:function(){return Y.isChrdev(this.mode)}}}));var o=new Y.FSNode(e,t,r,n);return Y.hashAddNode(o),o},destroyNode:function(e){Y.hashRemoveNode(e)},isRoot:function(e){return e===e.parent},isMountpoint:function(e){return!!e.mounted},isFile:function(e){return 32768==(61440&e)},isDir:function(e){return 16384==(61440&e)},isLink:function(e){return 40960==(61440&e)},isChrdev:function(e){return 8192==(61440&e)},isBlkdev:function(e){return 24576==(61440&e)},isFIFO:function(e){return 4096==(61440&e)},isSocket:function(e){return 49152==(49152&e)},flagModes:{r:0,rs:1052672,"r+":2,w:577,wx:705,xw:705,"w+":578,"wx+":706,"xw+":706,a:1089,ax:1217,xa:1217,"a+":1090,"ax+":1218,"xa+":1218},modeStringToFlags:function(e){var t=Y.flagModes[e];if(void 0===t)throw new Error("Unknown file open mode: "+e);return t},flagsToPermissionString:function(e){var t=["r","w","rw"][3&e];return 512&e&&(t+="w"),t},nodePermissions:function(e,t){return Y.ignorePermissions?0:(-1===t.indexOf("r")||292&e.mode)&&(-1===t.indexOf("w")||146&e.mode)&&(-1===t.indexOf("x")||73&e.mode)?0:13},mayLookup:function(e){return Y.nodePermissions(e,"x")||(e.node_ops.lookup?0:13)},mayCreate:function(e,r){try{return Y.lookupNode(e,r),17}catch(t){}return Y.nodePermissions(e,"wx")},mayDelete:function(e,r,n){var o;try{o=Y.lookupNode(e,r)}catch(t){return t.errno}var i=Y.nodePermissions(e,"wx");if(i)return i;if(n){if(!Y.isDir(o.mode))return 20;if(Y.isRoot(o)||Y.getPath(o)===Y.cwd())return 16}else if(Y.isDir(o.mode))return 21;return 0},mayOpen:function(e,t){return e?Y.isLink(e.mode)?40:Y.isDir(e.mode)&&("r"!==Y.flagsToPermissionString(t)||512&t)?21:Y.nodePermissions(e,Y.flagsToPermissionString(t)):2},MAX_OPEN_FDS:4096,nextfd:function(e,t){e=e||0,t=t||Y.MAX_OPEN_FDS;for(var r=e;r<=t;r++)if(!Y.streams[r])return r;throw new Y.ErrnoError(24)},getStream:function(e){return Y.streams[e]},createStream:function(e,t,r){Y.FSStream||(Y.FSStream=function(){},Y.FSStream.prototype={},Object.defineProperties(Y.FSStream.prototype,{object:{get:function(){return this.node},set:function(e){this.node=e}},isRead:{get:function(){return 1!=(2097155&this.flags)}},isWrite:{get:function(){return 0!=(2097155&this.flags)}},isAppend:{get:function(){return 1024&this.flags}}}));var n=new Y.FSStream;for(var o in e)n[o]=e[o];e=n;var i=Y.nextfd(t,r);return e.fd=i,Y.streams[i]=e,e},closeStream:function(e){Y.streams[e]=null},chrdev_stream_ops:{open:function(e){var t=Y.getDevice(e.node.rdev);e.stream_ops=t.stream_ops,e.stream_ops.open&&e.stream_ops.open(e)},llseek:function(){throw new Y.ErrnoError(29)}},major:function(e){return e>>8},minor:function(e){return 255&e},makedev:function(e,t){return e<<8|t},registerDevice:function(e,t){Y.devices[e]={stream_ops:t}},getDevice:function(e){return Y.devices[e]},getMounts:function(e){for(var t=[],r=[e];r.length;){var n=r.pop();t.push(n),r.push.apply(r,n.mounts)}return t},syncfs:function(e,t){"function"==typeof e&&(t=e,e=!1),Y.syncFSRequests++,Y.syncFSRequests>1&&console.log("warning: "+Y.syncFSRequests+" FS.syncfs operations in flight at once, probably just doing extra work");var r=Y.getMounts(Y.root.mount),n=0;function o(e){return Y.syncFSRequests--,t(e)}function i(e){if(e)return i.errored?void 0:(i.errored=!0,o(e));++n>=r.length&&o(null)}r.forEach(function(t){if(!t.type.syncfs)return i(null);t.type.syncfs(t,e,i)})},mount:function(e,t,r){var n,o="/"===r,i=!r;if(o&&Y.root)throw new Y.ErrnoError(16);if(!o&&!i){var a=Y.lookupPath(r,{follow_mount:!1});if(r=a.path,n=a.node,Y.isMountpoint(n))throw new Y.ErrnoError(16);if(!Y.isDir(n.mode))throw new Y.ErrnoError(20)}var s={type:e,opts:t,mountpoint:r,mounts:[]},u=e.mount(s);return u.mount=s,s.root=u,o?Y.root=u:n&&(n.mounted=s,n.mount&&n.mount.mounts.push(s)),u},unmount:function(e){var t=Y.lookupPath(e,{follow_mount:!1});if(!Y.isMountpoint(t.node))throw new Y.ErrnoError(22);var r=t.node,n=r.mounted,o=Y.getMounts(n);Object.keys(Y.nameTable).forEach(function(e){for(var t=Y.nameTable[e];t;){var r=t.name_next;-1!==o.indexOf(t.mount)&&Y.destroyNode(t),t=r}}),r.mounted=null;var i=r.mount.mounts.indexOf(n);r.mount.mounts.splice(i,1)},lookup:function(e,t){return e.node_ops.lookup(e,t)},mknod:function(e,t,r){var n=Y.lookupPath(e,{parent:!0}).node,o=X.basename(e);if(!o||"."===o||".."===o)throw new Y.ErrnoError(22);var i=Y.mayCreate(n,o);if(i)throw new Y.ErrnoError(i);if(!n.node_ops.mknod)throw new Y.ErrnoError(1);return n.node_ops.mknod(n,o,t,r)},create:function(e,t){return t=void 0!==t?t:438,t&=4095,t|=32768,Y.mknod(e,t,0)},mkdir:function(e,t){return t=void 0!==t?t:511,t&=1023,t|=16384,Y.mknod(e,t,0)},mkdirTree:function(e,r){for(var n=e.split("/"),o="",i=0;i<n.length;++i)if(n[i]){o+="/"+n[i];try{Y.mkdir(o,r)}catch(t){if(17!=t.errno)throw t}}},mkdev:function(e,t,r){return void 0===r&&(r=t,t=438),t|=8192,Y.mknod(e,t,r)},symlink:function(e,t){if(!K.resolve(e))throw new Y.ErrnoError(2);var r=Y.lookupPath(t,{parent:!0}).node;if(!r)throw new Y.ErrnoError(2);var n=X.basename(t),o=Y.mayCreate(r,n);if(o)throw new Y.ErrnoError(o);if(!r.node_ops.symlink)throw new Y.ErrnoError(1);return r.node_ops.symlink(r,n,e)},rename:function(e,r){var n,o,i=X.dirname(e),a=X.dirname(r),s=X.basename(e),u=X.basename(r);try{n=Y.lookupPath(e,{parent:!0}).node,o=Y.lookupPath(r,{parent:!0}).node}catch(t){throw new Y.ErrnoError(16)}if(!n||!o)throw new Y.ErrnoError(2);if(n.mount!==o.mount)throw new Y.ErrnoError(18);var l,c=Y.lookupNode(n,s),d=K.relative(e,a);if("."!==d.charAt(0))throw new Y.ErrnoError(22);if("."!==(d=K.relative(r,i)).charAt(0))throw new Y.ErrnoError(39);try{l=Y.lookupNode(o,u)}catch(t){}if(c!==l){var f=Y.isDir(c.mode),p=Y.mayDelete(n,s,f);if(p)throw new Y.ErrnoError(p);if(p=l?Y.mayDelete(o,u,f):Y.mayCreate(o,u))throw new Y.ErrnoError(p);if(!n.node_ops.rename)throw new Y.ErrnoError(1);if(Y.isMountpoint(c)||l&&Y.isMountpoint(l))throw new Y.ErrnoError(16);if(o!==n&&(p=Y.nodePermissions(n,"w")))throw new Y.ErrnoError(p);try{Y.trackingDelegate.willMovePath&&Y.trackingDelegate.willMovePath(e,r)}catch(t){console.log("FS.trackingDelegate['willMovePath']('"+e+"', '"+r+"') threw an exception: "+t.message)}Y.hashRemoveNode(c);try{n.node_ops.rename(c,o,u)}catch(t){throw t}finally{Y.hashAddNode(c)}try{Y.trackingDelegate.onMovePath&&Y.trackingDelegate.onMovePath(e,r)}catch(t){console.log("FS.trackingDelegate['onMovePath']('"+e+"', '"+r+"') threw an exception: "+t.message)}}},rmdir:function(e){var r=Y.lookupPath(e,{parent:!0}).node,n=X.basename(e),o=Y.lookupNode(r,n),i=Y.mayDelete(r,n,!0);if(i)throw new Y.ErrnoError(i);if(!r.node_ops.rmdir)throw new Y.ErrnoError(1);if(Y.isMountpoint(o))throw new Y.ErrnoError(16);try{Y.trackingDelegate.willDeletePath&&Y.trackingDelegate.willDeletePath(e)}catch(t){console.log("FS.trackingDelegate['willDeletePath']('"+e+"') threw an exception: "+t.message)}r.node_ops.rmdir(r,n),Y.destroyNode(o);try{Y.trackingDelegate.onDeletePath&&Y.trackingDelegate.onDeletePath(e)}catch(t){console.log("FS.trackingDelegate['onDeletePath']('"+e+"') threw an exception: "+t.message)}},readdir:function(e){var t=Y.lookupPath(e,{follow:!0}).node;if(!t.node_ops.readdir)throw new Y.ErrnoError(20);return t.node_ops.readdir(t)},unlink:function(e){var r=Y.lookupPath(e,{parent:!0}).node,n=X.basename(e),o=Y.lookupNode(r,n),i=Y.mayDelete(r,n,!1);if(i)throw new Y.ErrnoError(i);if(!r.node_ops.unlink)throw new Y.ErrnoError(1);if(Y.isMountpoint(o))throw new Y.ErrnoError(16);try{Y.trackingDelegate.willDeletePath&&Y.trackingDelegate.willDeletePath(e)}catch(t){console.log("FS.trackingDelegate['willDeletePath']('"+e+"') threw an exception: "+t.message)}r.node_ops.unlink(r,n),Y.destroyNode(o);try{Y.trackingDelegate.onDeletePath&&Y.trackingDelegate.onDeletePath(e)}catch(t){console.log("FS.trackingDelegate['onDeletePath']('"+e+"') threw an exception: "+t.message)}},readlink:function(e){var t=Y.lookupPath(e).node;if(!t)throw new Y.ErrnoError(2);if(!t.node_ops.readlink)throw new Y.ErrnoError(22);return K.resolve(Y.getPath(t.parent),t.node_ops.readlink(t))},stat:function(e,t){var r=Y.lookupPath(e,{follow:!t}).node;if(!r)throw new Y.ErrnoError(2);if(!r.node_ops.getattr)throw new Y.ErrnoError(1);return r.node_ops.getattr(r)},lstat:function(e){return Y.stat(e,!0)},chmod:function(e,t,r){var n;if(!(n="string"==typeof e?Y.lookupPath(e,{follow:!r}).node:e).node_ops.setattr)throw new Y.ErrnoError(1);n.node_ops.setattr(n,{mode:4095&t|-4096&n.mode,timestamp:Date.now()})},lchmod:function(e,t){Y.chmod(e,t,!0)},fchmod:function(e,t){var r=Y.getStream(e);if(!r)throw new Y.ErrnoError(9);Y.chmod(r.node,t)},chown:function(e,t,r,n){var o;if(!(o="string"==typeof e?Y.lookupPath(e,{follow:!n}).node:e).node_ops.setattr)throw new Y.ErrnoError(1);o.node_ops.setattr(o,{timestamp:Date.now()})},lchown:function(e,t,r){Y.chown(e,t,r,!0)},fchown:function(e,t,r){var n=Y.getStream(e);if(!n)throw new Y.ErrnoError(9);Y.chown(n.node,t,r)},truncate:function(e,t){if(t<0)throw new Y.ErrnoError(22);var r;if(!(r="string"==typeof e?Y.lookupPath(e,{follow:!0}).node:e).node_ops.setattr)throw new Y.ErrnoError(1);if(Y.isDir(r.mode))throw new Y.ErrnoError(21);if(!Y.isFile(r.mode))throw new Y.ErrnoError(22);var n=Y.nodePermissions(r,"w");if(n)throw new Y.ErrnoError(n);r.node_ops.setattr(r,{size:t,timestamp:Date.now()})},ftruncate:function(e,t){var r=Y.getStream(e);if(!r)throw new Y.ErrnoError(9);if(0==(2097155&r.flags))throw new Y.ErrnoError(22);Y.truncate(r.node,t)},utime:function(e,t,r){var n=Y.lookupPath(e,{follow:!0}).node;n.node_ops.setattr(n,{timestamp:Math.max(t,r)})},open:function(e,r,o,i,a){if(""===e)throw new Y.ErrnoError(2);var s;if(o=void 0===o?438:o,o=64&(r="string"==typeof r?Y.modeStringToFlags(r):r)?4095&o|32768:0,"object"==typeof e)s=e;else{e=X.normalize(e);try{s=Y.lookupPath(e,{follow:!(131072&r)}).node}catch(t){}}var u=!1;if(64&r)if(s){if(128&r)throw new Y.ErrnoError(17)}else s=Y.mknod(e,o,0),u=!0;if(!s)throw new Y.ErrnoError(2);if(Y.isChrdev(s.mode)&&(r&=-513),65536&r&&!Y.isDir(s.mode))throw new Y.ErrnoError(20);if(!u){var l=Y.mayOpen(s,r);if(l)throw new Y.ErrnoError(l)}512&r&&Y.truncate(s,0),r&=-641;var c=Y.createStream({node:s,path:Y.getPath(s),flags:r,seekable:!0,position:0,stream_ops:s.stream_ops,ungotten:[],error:!1},i,a);c.stream_ops.open&&c.stream_ops.open(c),!n.logReadFiles||1&r||(Y.readFiles||(Y.readFiles={}),e in Y.readFiles||(Y.readFiles[e]=1,console.log("FS.trackingDelegate error on read file: "+e)));try{if(Y.trackingDelegate.onOpenFile){var d=0;1!=(2097155&r)&&(d|=Y.tracking.openFlags.READ),0!=(2097155&r)&&(d|=Y.tracking.openFlags.WRITE),Y.trackingDelegate.onOpenFile(e,d)}}catch(t){console.log("FS.trackingDelegate['onOpenFile']('"+e+"', flags) threw an exception: "+t.message)}return c},close:function(e){if(Y.isClosed(e))throw new Y.ErrnoError(9);e.getdents&&(e.getdents=null);try{e.stream_ops.close&&e.stream_ops.close(e)}catch(t){throw t}finally{Y.closeStream(e.fd)}e.fd=null},isClosed:function(e){return null===e.fd},llseek:function(e,t,r){if(Y.isClosed(e))throw new Y.ErrnoError(9);if(!e.seekable||!e.stream_ops.llseek)throw new Y.ErrnoError(29);if(0!=r&&1!=r&&2!=r)throw new Y.ErrnoError(22);return e.position=e.stream_ops.llseek(e,t,r),e.ungotten=[],e.position},read:function(e,t,r,n,o){if(n<0||o<0)throw new Y.ErrnoError(22);if(Y.isClosed(e))throw new Y.ErrnoError(9);if(1==(2097155&e.flags))throw new Y.ErrnoError(9);if(Y.isDir(e.node.mode))throw new Y.ErrnoError(21);if(!e.stream_ops.read)throw new Y.ErrnoError(22);var i=void 0!==o;if(i){if(!e.seekable)throw new Y.ErrnoError(29)}else o=e.position;var a=e.stream_ops.read(e,t,r,n,o);return i||(e.position+=a),a},write:function(e,r,n,o,i,a){if(o<0||i<0)throw new Y.ErrnoError(22);if(Y.isClosed(e))throw new Y.ErrnoError(9);if(0==(2097155&e.flags))throw new Y.ErrnoError(9);if(Y.isDir(e.node.mode))throw new Y.ErrnoError(21);if(!e.stream_ops.write)throw new Y.ErrnoError(22);1024&e.flags&&Y.llseek(e,0,2);var s=void 0!==i;if(s){if(!e.seekable)throw new Y.ErrnoError(29)}else i=e.position;var u=e.stream_ops.write(e,r,n,o,i,a);s||(e.position+=u);try{e.path&&Y.trackingDelegate.onWriteToFile&&Y.trackingDelegate.onWriteToFile(e.path)}catch(t){console.log("FS.trackingDelegate['onWriteToFile']('"+e.path+"') threw an exception: "+t.message)}return u},allocate:function(e,t,r){if(Y.isClosed(e))throw new Y.ErrnoError(9);if(t<0||r<=0)throw new Y.ErrnoError(22);if(0==(2097155&e.flags))throw new Y.ErrnoError(9);if(!Y.isFile(e.node.mode)&&!Y.isDir(e.node.mode))throw new Y.ErrnoError(19);if(!e.stream_ops.allocate)throw new Y.ErrnoError(95);e.stream_ops.allocate(e,t,r)},mmap:function(e,t,r,n,o,i,a){if(0!=(2&i)&&0==(2&a)&&2!=(2097155&e.flags))throw new Y.ErrnoError(13);if(1==(2097155&e.flags))throw new Y.ErrnoError(13);if(!e.stream_ops.mmap)throw new Y.ErrnoError(19);return e.stream_ops.mmap(e,t,r,n,o,i,a)},msync:function(e,t,r,n,o){return e&&e.stream_ops.msync?e.stream_ops.msync(e,t,r,n,o):0},munmap:function(e){return 0},ioctl:function(e,t,r){if(!e.stream_ops.ioctl)throw new Y.ErrnoError(25);return e.stream_ops.ioctl(e,t,r)},readFile:function(e,t){if((t=t||{}).flags=t.flags||"r",t.encoding=t.encoding||"binary","utf8"!==t.encoding&&"binary"!==t.encoding)throw new Error('Invalid encoding type "'+t.encoding+'"');var r,n=Y.open(e,t.flags),o=Y.stat(e).size,i=new Uint8Array(o);return Y.read(n,i,0,o,0),"utf8"===t.encoding?r=w(i,0):"binary"===t.encoding&&(r=i),Y.close(n),r},writeFile:function(e,t,r){(r=r||{}).flags=r.flags||"w";var n=Y.open(e,r.flags,r.mode);if("string"==typeof t){var o=new Uint8Array(E(t)+1),i=b(t,o,0,o.length);Y.write(n,o,0,i,void 0,r.canOwn)}else{if(!ArrayBuffer.isView(t))throw new Error("Unsupported data type");Y.write(n,t,0,t.byteLength,void 0,r.canOwn)}Y.close(n)},cwd:function(){return Y.currentPath},chdir:function(e){var t=Y.lookupPath(e,{follow:!0});if(null===t.node)throw new Y.ErrnoError(2);if(!Y.isDir(t.node.mode))throw new Y.ErrnoError(20);var r=Y.nodePermissions(t.node,"x");if(r)throw new Y.ErrnoError(r);Y.currentPath=t.path},createDefaultDirectories:function(){Y.mkdir("/tmp"),Y.mkdir("/home"),Y.mkdir("/home/web_user")},createDefaultDevices:function(){var e;if(Y.mkdir("/dev"),Y.registerDevice(Y.makedev(1,3),{read:function(){return 0},write:function(e,t,r,n,o){return n}}),Y.mkdev("/dev/null",Y.makedev(1,3)),V.register(Y.makedev(5,0),V.default_tty_ops),V.register(Y.makedev(6,0),V.default_tty1_ops),Y.mkdev("/dev/tty",Y.makedev(5,0)),Y.mkdev("/dev/tty1",Y.makedev(6,0)),"object"==typeof crypto&&"function"==typeof crypto.getRandomValues){var t=new Uint8Array(1);e=function(){return crypto.getRandomValues(t),t[0]}}e||(e=function(){ae("random_device")}),Y.createDevice("/dev","random",e),Y.createDevice("/dev","urandom",e),Y.mkdir("/dev/shm"),Y.mkdir("/dev/shm/tmp")},createSpecialDirectories:function(){Y.mkdir("/proc"),Y.mkdir("/proc/self"),Y.mkdir("/proc/self/fd"),Y.mount({mount:function(){var e=Y.createNode("/proc/self","fd",16895,73);return e.node_ops={lookup:function(e,t){var r=+t,n=Y.getStream(r);if(!n)throw new Y.ErrnoError(9);var o={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:function(){return n.path}}};return o.parent=o,o}},e}},{},"/proc/self/fd")},createStandardStreams:function(){n.stdin?Y.createDevice("/dev","stdin",n.stdin):Y.symlink("/dev/tty","/dev/stdin"),n.stdout?Y.createDevice("/dev","stdout",null,n.stdout):Y.symlink("/dev/tty","/dev/stdout"),n.stderr?Y.createDevice("/dev","stderr",null,n.stderr):Y.symlink("/dev/tty1","/dev/stderr"),Y.open("/dev/stdin","r"),Y.open("/dev/stdout","w"),Y.open("/dev/stderr","w")},ensureErrnoError:function(){Y.ErrnoError||(Y.ErrnoError=function(e,t){this.node=t,this.setErrno=function(e){this.errno=e},this.setErrno(e),this.message="FS error",this.stack&&Object.defineProperty(this,"stack",{value:(new Error).stack,writable:!0})},Y.ErrnoError.prototype=new Error,Y.ErrnoError.prototype.constructor=Y.ErrnoError,[2].forEach(function(e){Y.genericErrors[e]=new Y.ErrnoError(e),Y.genericErrors[e].stack="<generic error, no stack>"}))},staticInit:function(){Y.ensureErrnoError(),Y.nameTable=new Array(4096),Y.mount(J,{},"/"),Y.createDefaultDirectories(),Y.createDefaultDevices(),Y.createSpecialDirectories(),Y.filesystems={MEMFS:J}},init:function(e,t,r){Y.init.initialized=!0,Y.ensureErrnoError(),n.stdin=e||n.stdin,n.stdout=t||n.stdout,n.stderr=r||n.stderr,Y.createStandardStreams()},quit:function(){Y.init.initialized=!1;var e=n._fflush;e&&e(0);for(var t=0;t<Y.streams.length;t++){var r=Y.streams[t];r&&Y.close(r)}},getMode:function(e,t){var r=0;return e&&(r|=365),t&&(r|=146),r},joinPath:function(e,t){var r=X.join.apply(null,e);return t&&"/"==r[0]&&(r=r.substr(1)),r},absolutePath:function(e,t){return K.resolve(t,e)},standardizePath:function(e){return X.normalize(e)},findObject:function(e,t){var r=Y.analyzePath(e,t);return r.exists?r.object:($(r.error),null)},analyzePath:function(e,r){try{e=(o=Y.lookupPath(e,{follow:!r})).path}catch(t){}var n={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var o=Y.lookupPath(e,{parent:!0});n.parentExists=!0,n.parentPath=o.path,n.parentObject=o.node,n.name=X.basename(e),o=Y.lookupPath(e,{follow:!r}),n.exists=!0,n.path=o.path,n.object=o.node,n.name=o.node.name,n.isRoot="/"===o.path}catch(t){n.error=t.errno}return n},createFolder:function(e,t,r,n){var o=X.join2("string"==typeof e?e:Y.getPath(e),t),i=Y.getMode(r,n);return Y.mkdir(o,i)},createPath:function(e,r,n,o){e="string"==typeof e?e:Y.getPath(e);for(var i=r.split("/").reverse();i.length;){var a=i.pop();if(a){var s=X.join2(e,a);try{Y.mkdir(s)}catch(t){}e=s}}return s},createFile:function(e,t,r,n,o){var i=X.join2("string"==typeof e?e:Y.getPath(e),t),a=Y.getMode(n,o);return Y.create(i,a)},createDataFile:function(e,t,r,n,o,i){var a=t?X.join2("string"==typeof e?e:Y.getPath(e),t):e,s=Y.getMode(n,o),u=Y.create(a,s);if(r){if("string"==typeof r){for(var l=new Array(r.length),c=0,d=r.length;c<d;++c)l[c]=r.charCodeAt(c);r=l}Y.chmod(u,146|s);var f=Y.open(u,"w");Y.write(f,r,0,r.length,0,i),Y.close(f),Y.chmod(u,s)}return u},createDevice:function(e,r,n,o){var i=X.join2("string"==typeof e?e:Y.getPath(e),r),a=Y.getMode(!!n,!!o);Y.createDevice.major||(Y.createDevice.major=64);var s=Y.makedev(Y.createDevice.major++,0);return Y.registerDevice(s,{open:function(e){e.seekable=!1},close:function(e){o&&o.buffer&&o.buffer.length&&o(10)},read:function(e,r,o,i,a){for(var s=0,u=0;u<i;u++){var l;try{l=n()}catch(t){throw new Y.ErrnoError(5)}if(void 0===l&&0===s)throw new Y.ErrnoError(11);if(null==l)break;s++,r[o+u]=l}return s&&(e.node.timestamp=Date.now()),s},write:function(e,r,n,i,a){for(var s=0;s<i;s++)try{o(r[n+s])}catch(t){throw new Y.ErrnoError(5)}return i&&(e.node.timestamp=Date.now()),s}}),Y.mkdev(i,a,s)},createLink:function(e,t,r,n,o){var i=X.join2("string"==typeof e?e:Y.getPath(e),t);return Y.symlink(r,i)},forceLoadFile:function(e){if(e.isDevice||e.isFolder||e.link||e.contents)return!0;var r=!0;if("undefined"!=typeof XMLHttpRequest)throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(!n.read)throw new Error("Cannot load without read() or XMLHttpRequest.");try{e.contents=ee(n.read(e.url),!0),e.usedBytes=e.contents.length}catch(t){r=!1}return r||$(5),r},createLazyFile:function(e,t,r,n,o){function i(){this.lengthKnown=!1,this.chunks=[]}if(i.prototype.get=function(e){if(!(e>this.length-1||e<0)){var t=e%this.chunkSize,r=e/this.chunkSize|0;return this.getter(r)[t]}},i.prototype.setDataGetter=function(e){this.getter=e},i.prototype.cacheLength=function(){var e=new XMLHttpRequest;if(e.open("HEAD",r,!1),e.send(null),!(e.status>=200&&e.status<300||304===e.status))throw new Error("Couldn't load "+r+". Status: "+e.status);var t,n=Number(e.getResponseHeader("Content-length")),o=(t=e.getResponseHeader("Accept-Ranges"))&&"bytes"===t,i=(t=e.getResponseHeader("Content-Encoding"))&&"gzip"===t,a=1048576;o||(a=n);var s=this;s.setDataGetter(function(e){var t=e*a,o=(e+1)*a-1;if(o=Math.min(o,n-1),void 0===s.chunks[e]&&(s.chunks[e]=function(e,t){if(e>t)throw new Error("invalid range ("+e+", "+t+") or no bytes requested!");if(t>n-1)throw new Error("only "+n+" bytes available! programmer error!");var o=new XMLHttpRequest;if(o.open("GET",r,!1),n!==a&&o.setRequestHeader("Range","bytes="+e+"-"+t),"undefined"!=typeof Uint8Array&&(o.responseType="arraybuffer"),o.overrideMimeType&&o.overrideMimeType("text/plain; charset=x-user-defined"),o.send(null),!(o.status>=200&&o.status<300||304===o.status))throw new Error("Couldn't load "+r+". Status: "+o.status);return void 0!==o.response?new Uint8Array(o.response||[]):ee(o.responseText||"",!0)}(t,o)),void 0===s.chunks[e])throw new Error("doXHR failed!");return s.chunks[e]}),!i&&n||(a=n=1,n=this.getter(0).length,a=n,console.log("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=n,this._chunkSize=a,this.lengthKnown=!0},"undefined"!=typeof XMLHttpRequest){if(!a)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var s=new i;Object.defineProperties(s,{length:{get:function(){return this.lengthKnown||this.cacheLength(),this._length}},chunkSize:{get:function(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}});var u={isDevice:!1,contents:s}}else u={isDevice:!1,url:r};var l=Y.createFile(e,t,u,n,o);u.contents?l.contents=u.contents:u.url&&(l.contents=null,l.url=u.url),Object.defineProperties(l,{usedBytes:{get:function(){return this.contents.length}}});var c={};return Object.keys(l.stream_ops).forEach(function(e){var t=l.stream_ops[e];c[e]=function(){if(!Y.forceLoadFile(l))throw new Y.ErrnoError(5);return t.apply(null,arguments)}}),c.read=function(e,t,r,n,o){if(!Y.forceLoadFile(l))throw new Y.ErrnoError(5);var i=e.node.contents;if(o>=i.length)return 0;var a=Math.min(i.length-o,n);if(i.slice)for(var s=0;s<a;s++)t[r+s]=i[o+s];else for(s=0;s<a;s++)t[r+s]=i.get(o+s);return a},l.stream_ops=c,l},createPreloadedFile:function(e,t,r,o,i,a,s,u,l,c){Browser.init();var d=t?K.resolve(X.join2(e,t)):e;function f(r){function f(r){c&&c(),u||Y.createDataFile(e,t,r,o,i,l),a&&a(),j()}var p=!1;n.preloadPlugins.forEach(function(e){p||e.canHandle(d)&&(e.handle(r,d,f,function(){s&&s(),j()}),p=!0)}),p||f(r)}N(),"string"==typeof r?Browser.asyncLoad(r,function(e){f(e)},s):f(r)},indexedDB:function(){return window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB},DB_NAME:function(){return"EM_FS_"+window.location.pathname},DB_VERSION:20,DB_STORE_NAME:"FILE_DATA",saveFilesToDB:function(e,r,n){r=r||function(){},n=n||function(){};var o=Y.indexedDB();try{var i=o.open(Y.DB_NAME(),Y.DB_VERSION)}catch(t){return n(t)}i.onupgradeneeded=function(){console.log("creating db"),i.result.createObjectStore(Y.DB_STORE_NAME)},i.onsuccess=function(){var t=i.result.transaction([Y.DB_STORE_NAME],"readwrite"),o=t.objectStore(Y.DB_STORE_NAME),a=0,s=0,u=e.length;function l(){0==s?r():n()}e.forEach(function(e){var t=o.put(Y.analyzePath(e).object.contents,e);t.onsuccess=function(){++a+s==u&&l()},t.onerror=function(){a+ ++s==u&&l()}}),t.onerror=n},i.onerror=n},loadFilesFromDB:function(e,r,n){r=r||function(){},n=n||function(){};var o=Y.indexedDB();try{var i=o.open(Y.DB_NAME(),Y.DB_VERSION)}catch(t){return n(t)}i.onupgradeneeded=n,i.onsuccess=function(){var o=i.result;try{var a=o.transaction([Y.DB_STORE_NAME],"readonly")}catch(t){return void n(t)}var s=a.objectStore(Y.DB_STORE_NAME),u=0,l=0,c=e.length;function d(){0==l?r():n()}e.forEach(function(e){var t=s.get(e);t.onsuccess=function(){Y.analyzePath(e).exists&&Y.unlink(e),Y.createDataFile(X.dirname(e),X.basename(e),t.result,!0,!0,!0),++u+l==c&&d()},t.onerror=function(){u+ ++l==c&&d()}}),a.onerror=n},i.onerror=n}},Z={DEFAULT_POLLMASK:5,mappings:{},umask:511,calculateAt:function(e,t){if("/"!==t[0]){var r;if(-100===e)r=Y.cwd();else{var n=Y.getStream(e);if(!n)throw new Y.ErrnoError(9);r=n.path}t=X.join2(r,t)}return t},doStat:function(e,r,n){try{var o=e(r)}catch(t){if(t&&t.node&&X.normalize(r)!==X.normalize(Y.getPath(t.node)))return-20;throw t}return _[n>>2]=o.dev,_[n+4>>2]=0,_[n+8>>2]=o.ino,_[n+12>>2]=o.mode,_[n+16>>2]=o.nlink,_[n+20>>2]=o.uid,_[n+24>>2]=o.gid,_[n+28>>2]=o.rdev,_[n+32>>2]=0,tempI64=[o.size>>>0,(tempDouble=o.size,+x(tempDouble)>=1?tempDouble>0?(0|R(+M(tempDouble/4294967296),4294967295))>>>0:~~+L((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)],_[n+40>>2]=tempI64[0],_[n+44>>2]=tempI64[1],_[n+48>>2]=4096,_[n+52>>2]=o.blocks,_[n+56>>2]=o.atime.getTime()/1e3|0,_[n+60>>2]=0,_[n+64>>2]=o.mtime.getTime()/1e3|0,_[n+68>>2]=0,_[n+72>>2]=o.ctime.getTime()/1e3|0,_[n+76>>2]=0,tempI64=[o.ino>>>0,(tempDouble=o.ino,+x(tempDouble)>=1?tempDouble>0?(0|R(+M(tempDouble/4294967296),4294967295))>>>0:~~+L((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)],_[n+80>>2]=tempI64[0],_[n+84>>2]=tempI64[1],0},doMsync:function(e,t,r,n){var o=new Uint8Array(h.subarray(e,e+r));Y.msync(t,o,0,r,n)},doMkdir:function(e,t){return"/"===(e=X.normalize(e))[e.length-1]&&(e=e.substr(0,e.length-1)),Y.mkdir(e,t,0),0},doMknod:function(e,t,r){switch(61440&t){case 32768:case 8192:case 24576:case 4096:case 49152:break;default:return-22}return Y.mknod(e,t,r),0},doReadlink:function(e,t,r){if(r<=0)return-22;var n=Y.readlink(e),o=Math.min(r,E(n)),i=p[t+o];return b(n,h,t,r+1),p[t+o]=i,o},doAccess:function(e,t){if(-8&t)return-22;var r;r=Y.lookupPath(e,{follow:!0}).node;var n="";return 4&t&&(n+="r"),2&t&&(n+="w"),1&t&&(n+="x"),n&&Y.nodePermissions(r,n)?-13:0},doDup:function(e,t,r){var n=Y.getStream(r);return n&&Y.close(n),Y.open(e,t,0,r,r).fd},doReadv:function(e,t,r,n){for(var o=0,i=0;i<r;i++){var a=_[t+8*i>>2],s=_[t+(8*i+4)>>2],u=Y.read(e,p,a,s,n);if(u<0)return-1;if(o+=u,u<s)break}return o},doWritev:function(e,t,r,n){for(var o=0,i=0;i<r;i++){var a=_[t+8*i>>2],s=_[t+(8*i+4)>>2],u=Y.write(e,p,a,s,n);if(u<0)return-1;o+=u}return o},varargs:0,get:function(e){return Z.varargs+=4,_[Z.varargs-4>>2]},getStr:function(){return v(Z.get())},getStreamFromFD:function(){var e=Y.getStream(Z.get());if(!e)throw new Y.ErrnoError(9);return e},get64:function(){var e=Z.get();return Z.get(),e},getZero:function(){Z.get()}};function Q(){return p.length}function ee(e,t,r){var n=r>0?r:E(e)+1,o=new Array(n),i=b(e,o,0,o.length);return t&&(o.length=i),o}Y.staticInit();var te={b:ae,p:function(){},h:$,k:function(e,r){Z.varargs=r;try{var n=Z.getStreamFromFD(),o=Z.get(),i=Z.get(),a=Z.get(),s=Z.get(),u=4294967296*o+(i>>>0);return u<=-9007199254740992||u>=9007199254740992?-75:(Y.llseek(n,u,s),tempI64=[n.position>>>0,(tempDouble=n.position,+x(tempDouble)>=1?tempDouble>0?(0|R(+M(tempDouble/4294967296),4294967295))>>>0:~~+L((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)],_[a>>2]=tempI64[0],_[a+4>>2]=tempI64[1],n.getdents&&0===u&&0===s&&(n.getdents=null),0)}catch(t){return void 0!==Y&&t instanceof Y.ErrnoError||ae(t),-t.errno}},j:function(e,r){Z.varargs=r;try{var n=Z.getStreamFromFD(),o=Z.get(),i=Z.get();return Z.doReadv(n,o,i)}catch(t){return void 0!==Y&&t instanceof Y.ErrnoError||ae(t),-t.errno}},g:function(e,r){Z.varargs=r;try{var n=Z.getStreamFromFD(),o=Z.get(),i=Z.get();return Z.doWritev(n,o,i)}catch(t){return void 0!==Y&&t instanceof Y.ErrnoError||ae(t),-t.errno}},c:function(e,r){Z.varargs=r;try{var n=Z.getStreamFromFD();switch(Z.get()){case 0:return(o=Z.get())<0?-22:Y.open(n.path,n.flags,0,o).fd;case 1:case 2:return 0;case 3:return n.flags;case 4:var o=Z.get();return n.flags|=o,0;case 12:return o=Z.get(),m[o+0>>1]=2,0;case 13:case 14:return 0;case 16:case 8:return-22;case 9:return $(22),-1;default:return-22}}catch(t){return void 0!==Y&&t instanceof Y.ErrnoError||ae(t),-t.errno}},i:function(e,r){Z.varargs=r;try{var n=Z.getStr(),o=Z.get(),i=Z.get();return Y.open(n,o,i).fd}catch(t){return void 0!==Y&&t instanceof Y.ErrnoError||ae(t),-t.errno}},f:function(e,r){Z.varargs=r;try{var n=Z.getStreamFromFD(),o=Z.get();switch(o){case 21509:case 21505:return n.tty?0:-25;case 21510:case 21511:case 21512:case 21506:case 21507:case 21508:return n.tty?0:-25;case 21519:if(!n.tty)return-25;var i=Z.get();return _[i>>2]=0,0;case 21520:return n.tty?-22:-25;case 21531:return i=Z.get(),Y.ioctl(n,o,i);case 21523:case 21524:return n.tty?0:-25;default:ae("bad ioctl syscall "+o)}}catch(t){return void 0!==Y&&t instanceof Y.ErrnoError||ae(t),-t.errno}},e:function(e,r){Z.varargs=r;try{var n=Z.getStreamFromFD();return Y.close(n),0}catch(t){return void 0!==Y&&t instanceof Y.ErrnoError||ae(t),-t.errno}},d:function(){},o:Q,n:function(e,t,r){h.set(h.subarray(t,t+r),e)},m:function(e){var r=Q();if(e>2147418112)return!1;for(var n=Math.max(r,16777216);n<e;)n=n<=536870912?k(2*n,65536):Math.min(k((3*n+2147483648)/4,65536),2147418112);return!!function(e){e=k(e,65536);var r=f.byteLength;try{return-1!==c.grow((e-r)/65536)&&(f=c.buffer,!0)}catch(t){return!1}}(n)&&(C(),!0)},l:function(e){ae("OOM")},a:10848},re=n.asm({},te,f);n.asm=re,n.___errno_location=function(){return n.asm.q.apply(null,arguments)},n._free=function(){return n.asm.r.apply(null,arguments)};var ne=n._malloc=function(){return n.asm.s.apply(null,arguments)};function oe(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function ie(e){function t(){n.calledRun||(n.calledRun=!0,g||(n.noFSInit||Y.init.initialized||Y.init(),V.init(),F(S),Y.ignorePermissions=!1,F(P),n.onRuntimeInitialized&&n.onRuntimeInitialized(),function(){if(n.postRun)for("function"==typeof n.postRun&&(n.postRun=[n.postRun]);n.postRun.length;)e=n.postRun.shift(),A.unshift(e);var e;F(A)}()))}e=e||n.arguments,B>0||(function(){if(n.preRun)for("function"==typeof n.preRun&&(n.preRun=[n.preRun]);n.preRun.length;)e=n.preRun.shift(),T.unshift(e);var e;F(T)}(),B>0||n.calledRun||(n.setStatus?(n.setStatus("Running..."),setTimeout(function(){setTimeout(function(){n.setStatus("")},1),t()},1)):t()))}function ae(e){throw n.onAbort&&n.onAbort(e),void 0!==e?(u(e),l(e),e='"'+e+'"'):e="",g=!0,"abort("+e+"). Build with -s ASSERTIONS=1 for more info."}if(n._mid_alloc_options=function(){return n.asm.t.apply(null,arguments)},n._mid_exit=function(){return n.asm.u.apply(null,arguments)},n._mid_get_load_request=function(){return n.asm.v.apply(null,arguments)},n._mid_get_load_request_count=function(){return n.asm.w.apply(null,arguments)},n._mid_init=function(){return n.asm.x.apply(null,arguments)},n._mid_istream_close=function(){return n.asm.y.apply(null,arguments)},n._mid_istream_open_mem=function(){return n.asm.z.apply(null,arguments)},n._mid_song_free=function(){return n.asm.A.apply(null,arguments)},n._mid_song_get_time=function(){return n.asm.B.apply(null,arguments)},n._mid_song_get_total_time=function(){return n.asm.C.apply(null,arguments)},n._mid_song_load=function(){return n.asm.D.apply(null,arguments)},n._mid_song_read_wave=function(){return n.asm.E.apply(null,arguments)},n._mid_song_seek=function(){return n.asm.F.apply(null,arguments)},n._mid_song_start=function(){return n.asm.G.apply(null,arguments)},n.stackAlloc=function(){return n.asm.H.apply(null,arguments)},n.asm=re,n.UTF8ToString=v,n.FS=Y,n.then=function(e){if(n.calledRun)e(n);else{var t=n.onRuntimeInitialized;n.onRuntimeInitialized=function(){t&&t(),e(n)}}return n},oe.prototype=new Error,oe.prototype.constructor=oe,I=function e(){n.calledRun||ie(),n.calledRun||(I=e)},n.run=ie,n.abort=ae,n.preInit)for("function"==typeof n.preInit&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();return n.noExitRuntime=!0,ie(),e});"object"==typeof j.exports?j.exports=U:"object"==typeof j.exports&&(j.exports.LibTimidity=U),j=j.exports;const H=w.EventEmitter,W=y("timidity"),q=y("timidity:verbose"),G="undefined"!=typeof window&&(window.AudioContext||window.webkitAudioContext);var X,$=class extends H{constructor(e="/"){super(),this.destroyed=!1,e.endsWith("/")||(e+="/"),this._baseUrl=new URL(e,window.location.origin).href,this._ready=!1,this._playing=!1,this._pendingFetches={},this._songPtr=0,this._bufferPtr=0,this._array=new Int16Array(32768),this._currentUrlOrBuf=null,this._interval=null,this._startInterval=this._startInterval.bind(this),this._stopInterval=this._stopInterval.bind(this),this._audioContext=new G,this._node=this._audioContext.createScriptProcessor(16384,0,2),this._onAudioProcess=this._onAudioProcess.bind(this),this._node.addEventListener("audioprocess",this._onAudioProcess),this._node.connect(this._audioContext.destination),this._lib=j({locateFile:e=>new URL(e,this._baseUrl).href,onRuntimeInitialized:()=>this._onLibReady()})}_onLibReady(){if(this._lib.FS.writeFile("/timidity.cfg","\ndrumset 0\n\n 25\tDrum_000/025_Snare_Roll.pat \n 26\tDrum_000/026_Snap.pat \n 27\tDrum_000/027_High_Q.pat \n 31\tDrum_000/031_Sticks.pat \n 32\tDrum_000/032_Square_Click.pat \n 33\tDrum_000/033_Metronome_Click.pat \n 34\tDrum_000/034_Metronome_Bell.pat \n 35\tDrum_000/035_Kick_1.pat amp=100\n 36\tDrum_000/036_Kick_2.pat amp=100\n 37\tDrum_000/037_Stick_Rim.pat \n 38\tDrum_000/038_Snare_1.pat \n 39\tDrum_000/039_Clap_Hand.pat amp=100\n 40\tDrum_000/040_Snare_2.pat \n 41\tDrum_000/041_Tom_Low_2.pat amp=100\n 42\tDrum_000/042_Hi-Hat_Closed.pat \n 43\tDrum_000/043_Tom_Low_1.pat amp=100\n 44\tDrum_000/044_Hi-Hat_Pedal.pat \n 45\tDrum_000/045_Tom_Mid_2.pat amp=100\n 46\tDrum_000/046_Hi-Hat_Open.pat \n 47\tDrum_000/047_Tom_Mid_1.pat amp=100\n 48\tDrum_000/048_Tom_High_2.pat amp=100\n 49\tDrum_000/049_Cymbal_Crash_1.pat \n 50\tDrum_000/050_Tom_High_1.pat amp=100\n 51\tDrum_000/051_Cymbal_Ride_1.pat \n 52\tDrum_000/052_Cymbal_Chinese.pat \n 53\tDrum_000/053_Cymbal_Ride_Bell.pat amp=100\n 54\tDrum_000/054_Tombourine.pat \n 55\tDrum_000/055_Cymbal_Splash.pat \n 56\tDrum_000/056_Cow_Bell.pat \n 57\tDrum_000/057_Cymbal_Crash_2.pat \n 58\tDrum_000/058_Vibra-Slap.pat \n 59\tDrum_000/059_Cymbal_Ride_2.pat \n 60\tDrum_000/060_Bongo_High.pat \n 61\tDrum_000/061_Bongo_Low.pat \n 62\tDrum_000/062_Conga_High_1_Mute.pat \n 63\tDrum_000/063_Conga_High_2_Open.pat \n 64\tDrum_000/064_Conga_Low.pat \n 65\tDrum_000/065_Timbale_High.pat \n 66\tDrum_000/066_Timbale_Low.pat \n 67\tDrum_000/067_Agogo_High.pat \n 68\tDrum_000/068_Agogo_Low.pat \n 69\tDrum_000/069_Cabasa.pat amp=100\n 70\tDrum_000/070_Maracas.pat \n 71\tDrum_000/071_Whistle_1_High_Short.pat \n 72\tDrum_000/072_Whistle_2_Low_Long.pat \n 73\tDrum_000/073_Guiro_1_Short.pat \n 74\tDrum_000/074_Guiro_2_Long.pat \n 75\tDrum_000/075_Claves.pat amp=100\n 76\tDrum_000/076_Wood_Block_1_High.pat \n 77\tDrum_000/077_Wood_Block_2_Low.pat \n 78\tDrum_000/078_Cuica_1_Mute.pat amp=100\n 79\tDrum_000/079_Cuica_2_Open.pat amp=100\n 80\tDrum_000/080_Triangle_1_Mute.pat \n 81\tDrum_000/081_Triangle_2_Open.pat \n 82\tDrum_000/082_Shaker.pat \n 84\tDrum_000/084_Belltree.pat \n\nbank 0\n\n 0\tTone_000/000_Acoustic_Grand_Piano.pat amp=120 pan=center\n 1\tTone_000/001_Acoustic_Brite_Piano.pat \n 2\tTone_000/002_Electric_Grand_Piano.pat \n 4\tTone_000/004_Electric_Piano_1_Rhodes.pat \n 5\tTone_000/005_Electric_Piano_2_Chorused_Yamaha_DX.pat \n 6\tTone_000/006_Harpsichord.pat \n 7\tTone_000/007_Clavinet.pat \n 8\tTone_000/008_Celesta.pat \n 9\tTone_000/009_Glockenspiel.pat \n 13\tTone_000/013_Xylophone.pat \n 14\tTone_000/014_Tubular_Bells.pat \n 15\tTone_000/015_Dulcimer.pat \n 16\tTone_000/016_Hammond_Organ.pat \n 19\tTone_000/019_Church_Organ.pat \n 21\tTone_000/021_Accordion.pat \n 23\tTone_000/023_Tango_Accordion.pat \n 24\tTone_000/024_Nylon_Guitar.pat \n 25\tTone_000/025_Steel_Guitar.pat \n 26\tTone_000/026_Jazz_Guitar.pat \n 27\tTone_000/027_Clean_Electric_Guitar.pat \n 28\tTone_000/028_Muted_Electric_Guitar.pat \n 29\tTone_000/029_Overdriven_Guitar.pat \n 30\tTone_000/030_Distortion_Guitar.pat \n 32\tTone_000/032_Acoustic_Bass.pat \n 33\tTone_000/033_Finger_Bass.pat \n 34\tTone_000/034_Pick_Bass.pat \n 35\tTone_000/035_Fretless_Bass.pat \n 36\tTone_000/036_Slap_Bass_1.pat \n 37\tTone_000/037_Slap_Bass_2.pat \n 38\tTone_000/038_Synth_Bass_1.pat \n 40\tTone_000/040_Violin.pat \n 42\tTone_000/042_Cello.pat \n 44\tTone_000/044_Tremolo_Strings.pat \n 45\tTone_000/045_Pizzicato_Strings.pat \n 46\tTone_000/046_Harp.pat \n 47\tTone_000/047_Timpani.pat \n 48\tTone_000/048_String_Ensemble_1_Marcato.pat \n 53\tTone_000/053_Voice_Oohs.pat \n 56\tTone_000/056_Trumpet.pat \n 57\tTone_000/057_Trombone.pat \n 58\tTone_000/058_Tuba.pat \n 59\tTone_000/059_Muted_Trumpet.pat \n 60\tTone_000/060_French_Horn.pat \n 61\tTone_000/061_Brass_Section.pat \n 64\tTone_000/064_Soprano_Sax.pat \n 65\tTone_000/065_Alto_Sax.pat \n 66\tTone_000/066_Tenor_Sax.pat \n 67\tTone_000/067_Baritone_Sax.pat \n 68\tTone_000/068_Oboe.pat \n 69\tTone_000/069_English_Horn.pat \n 70\tTone_000/070_Bassoon.pat \n 71\tTone_000/071_Clarinet.pat \n 72\tTone_000/072_Piccolo.pat \n 73\tTone_000/073_Flute.pat \n 74\tTone_000/074_Recorder.pat \n 75\tTone_000/075_Pan_Flute.pat \n 76\tTone_000/076_Bottle_Blow.pat \n 79\tTone_000/079_Ocarina.pat \n 80\tTone_000/080_Square_Wave.pat \n 84\tTone_000/084_Charang.pat \n 88\tTone_000/088_New_Age.pat \n 94\tTone_000/094_Halo_Pad.pat \n 95\tTone_000/095_Sweep_Pad.pat \n 98\tTone_000/098_Crystal.pat \n 101\tTone_000/101_Goblins--Unicorn.pat \n 102\tTone_000/102_Echo_Voice.pat \n 104\tTone_000/104_Sitar.pat \n 114\tTone_000/114_Steel_Drums.pat \n 115\tTone_000/115_Wood_Block.pat \n 120\tTone_000/120_Guitar_Fret_Noise.pat \n 122\tTone_000/122_Seashore.pat \n 125\tTone_000/125_Helicopter.pat \n\n"),0!==this._lib._mid_init("/timidity.cfg"))return this._destroy(new Error("Failed to initialize libtimidity"));this._bufferPtr=this._lib._malloc(65536),q("Initialized libtimidity"),this._ready=!0,this.emit("_ready")}async load(e){if(W("load %o",e),this.destroyed)throw new Error("load() called after destroy()");if(this._audioContext.resume(),this._songPtr&&this._destroySong(),this.emit("unstarted"),this._stopInterval(),!this._ready)return this.once("_ready",()=>this.load(e));let t;if(this.emit("buffering"),this._currentUrlOrBuf=e,"string"==typeof e){if(t=await this._fetch(new URL(e,this._baseUrl)),this._currentUrlOrBuf!==e)return}else{if(!(e instanceof Uint8Array))throw new Error("load() expects a `string` or `Uint8Array` argument");t=e}let r=this._loadSong(t),n=this._lib._mid_get_load_request_count(r);if(n>0){let o=this._getMissingInstruments(r,n);if(q("Fetching instruments: %o",o),await Promise.all(o.map(e=>this._fetchInstrument(e))),this._currentUrlOrBuf!==e)return;this._lib._mid_song_free(r),r=this._loadSong(t),(n=this._lib._mid_get_load_request_count(r))>0&&(o=this._getMissingInstruments(r,n),W("Playing with missing instruments: %o",o))}this._songPtr=r,this._lib._mid_song_start(this._songPtr),q("Song and instruments are loaded")}_getMissingInstruments(e,t){const r=[];for(let n=0;n<t;n++){const t=this._lib._mid_get_load_request(e,n),o=this._lib.UTF8ToString(t);r.push(o)}return r}_loadSong(e){const t=this._lib._mid_alloc_options(44100,32784,2,16384),r=this._lib._malloc(e.byteLength);this._lib.HEAPU8.set(e,r);const n=this._lib._mid_istream_open_mem(r,e.byteLength),o=this._lib._mid_song_load(n,t);return this._lib._mid_istream_close(n),this._lib._free(t),this._lib._free(r),0===o?this._destroy(new Error("Failed to load MIDI file")):o}async _fetchInstrument(e){if(this._pendingFetches[e])return this._pendingFetches[e];const t=new URL(e,this._baseUrl),r=this._fetch(t);this._pendingFetches[e]=r;const n=await r;return this._writeInstrumentFile(e,n),delete this._pendingFetches[e],n}_writeInstrumentFile(e,t){const r=e.split("/").slice(0,-1).join("/");this._mkdirp(r),this._lib.FS.writeFile(e,t,{encoding:"binary"})}_mkdirp(e){const t=e.split("/");let r="/";for(let n=0;n<t.length;n++){const e=t[n];try{this._lib.FS.mkdir(`${r}${e}`)}catch(Y){}r+=`${e}/`}}async _fetch(e){const t=await window.fetch(e,{mode:"cors",credentials:"same-origin"});if(200!==t.status)throw new Error(`Could not load ${e}`);const r=await t.arrayBuffer();return new Uint8Array(r)}play(){if(W("play"),this.destroyed)throw new Error("play() called after destroy()");this._audioContext.resume(),this._playing=!0,this._ready&&!this._currentUrlOrBuf&&(this.emit("playing"),this._startInterval())}_onAudioProcess(e){const t=this._songPtr&&this._playing?this._readMidiData():0;t>0&&this._currentUrlOrBuf&&(this._currentUrlOrBuf=null,this.emit("playing"),this._startInterval());const r=e.outputBuffer.getChannelData(0),n=e.outputBuffer.getChannelData(1);for(let o=0;o<t;o++)r[o]=this._array[2*o]/32767,n[o]=this._array[2*o+1]/32767;for(let o=t;o<16384;o++)r[o]=0,n[o]=0;this._songPtr&&this._playing&&0===t&&(this.emit("ended"),this.destroyed||(this.seek(0),this.pause()))}_readMidiData(){const e=this._lib._mid_song_read_wave(this._songPtr,this._bufferPtr,65536),t=e/4;return 0===t?0:(this._array.set(this._lib.HEAP16.subarray(this._bufferPtr/2,(this._bufferPtr+e)/2)),t)}pause(){if(W("pause"),this.destroyed)throw new Error("pause() called after destroy()");this._playing=!1,this._stopInterval(),this.emit("paused")}seek(e){if(W("seek %d",e),this.destroyed)throw new Error("seek() called after destroy()");if(!this._songPtr)return;const t=Math.floor(1e3*e);this._lib._mid_song_seek(this._songPtr,t),this._onTimeupdate()}get currentTime(){return this.destroyed||!this._songPtr?0:this._lib._mid_song_get_time(this._songPtr)/1e3}get duration(){return this.destroyed||!this._songPtr?1:this._lib._mid_song_get_total_time(this._songPtr)/1e3}_onTimeupdate(){this.emit("timeupdate",this.currentTime)}_startInterval(){this._onTimeupdate(),this._interval=setInterval(()=>this._onTimeupdate(),1e3)}_stopInterval(){this._onTimeupdate(),clearInterval(this._interval),this._interval=null}destroy(){if(W("destroy"),this.destroyed)throw new Error("destroy() called after destroy()");this._destroy()}_destroy(e){this.destroyed||(this.destroyed=!0,this._stopInterval(),this._array=null,this._songPtr&&this._destroySong(),this._bufferPtr&&(this._lib._free(this._bufferPtr),this._bufferPtr=0),this._node&&(this._node.disconnect(),this._node.removeEventListener("audioprocess",this._onAudioProcess)),this._audioContext&&this._audioContext.close(),e&&this.emit("error",e),W("destroyed (err %o)",e))}_destroySong(){this._lib._mid_song_free(this._songPtr),this._songPtr=0}},K={exports:{}};X=function(){"use strict";var e=["interactive","complete"],t=function(t,r){return new Promise(function(n){t&&"function"!=typeof t&&(r=t,t=null),r=r||window.document;var o=function(){return n(void(t&&setTimeout(t)))};-1!==e.indexOf(r.readyState)?o():r.addEventListener("DOMContentLoaded",o)})};return t.resume=function(e){return function(r){return t(e).then(function(){return r})}},t},"object"==typeof K.exports?K.exports=X():this.whenDomReady=X(),K=K.exports;const V=y("bg-sound");class J extends HTMLElement{static get observedAttributes(){return["src","baseUrl","loop"]}constructor(){super(),this._playingFired=!1,this._onClick=this._onClick.bind(this),this._onPlaying=this._onPlaying.bind(this),this._onEnded=this._onEnded.bind(this)}connectedCallback(){document.addEventListener("click",this._onClick),this.hasAttribute("baseUrl")||this.setAttribute("baseUrl","https://bitmidi.com/timidity/"),this.hasAttribute("loop")||this.setAttribute("loop",0),this.playCount=0,this._initPlayer()}disconnectedCallback(){document.removeEventListener("click",this._onClick),this._destroyPlayer()}get src(){return this.getAttribute("src")}set src(e){this.setAttribute("src",e)}get loop(){return this.getAttribute("loop")}set loop(e){this.setAttribute("loop",e)}get baseUrl(){return this.getAttribute("baseUrl")}set baseUrl(e){this.setAttribute("baseUrl",e)}attributeChangedCallback(e,t,r){V(`${e} changed from ${t} to ${r}`)}_initPlayer(){this.player=new $(this.baseUrl),this.player.once("playing",this._onPlaying),this.player.once("ended",this._onEnded),this.player.load(this.src),this.player.play()}_destroyPlayer(){this.player.pause(),this.player.destroy(),this.player.removeListener("playing",this._onPlaying),this.player.removeListener("ended",this._onEnded),this.player=null}_onPlaying(){this._playingFired=!0}_onEnded(){this._destroyPlayer(),this.playCount+=1;const e=String(this.loop).toLowerCase();("infinite"===e||"true"===e||"-1"===e||Number(this.loop)>this.playCount)&&this._initPlayer()}_onClick(){this._playingFired||this.player.play()}}window.customElements.define("bg-sound",J),J.enableCompatMode=function(e={}){R("\n    embed {\n      display: none;\n    }\n  "),K().then(()=>{[...document.querySelectorAll("embed"),...document.querySelectorAll("bgsound")].forEach(t=>{let r=t.getAttribute("src");const n=t.getAttribute("loop");if(t.remove(),r=new URL(r,window.location.href).href,console.log(r),r){if(r.endsWith(".mid")||r.endsWith(".midi")){const t=document.createElement("bg-sound");t.setAttribute("src",r),n&&t.setAttribute("loop",n),e.baseUrl&&t.setAttribute("baseUrl",e.baseUrl),document.body.appendChild(t)}if(r.endsWith(".wav")){const e=document.createElement("audio");e.src=r,e.controls=!1,e.autoplay=!0,n&&("infinite"===n.toLowerCase()||"true"===n||"-1"===n||Number(n)>=2)&&(e.loop=!0);let t=!1;e.addEventListener("playing",()=>{t=!0}),document.body.addEventListener("click",()=>{t||e.play()}),document.body.appendChild(e)}}})})}});